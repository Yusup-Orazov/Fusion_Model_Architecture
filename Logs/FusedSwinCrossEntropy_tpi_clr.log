Unable to disable persistence mode for GPU 00000000:5E:00.0: Insufficient Permissions
Unable to disable persistence mode for GPU 00000000:D8:00.0: Insufficient Permissions
Some weights of the model checkpoint at nvidia/segformer-b0-finetuned-ade-512-512 were not used when initializing SegformerModel: ['decode_head.linear_c.3.proj.weight', 'decode_head.batch_norm.running_var', 'decode_head.batch_norm.num_batches_tracked', 'decode_head.batch_norm.running_mean', 'decode_head.batch_norm.bias', 'decode_head.linear_c.3.proj.bias', 'decode_head.linear_c.0.proj.bias', 'decode_head.classifier.bias', 'decode_head.linear_c.1.proj.bias', 'decode_head.linear_c.2.proj.bias', 'decode_head.batch_norm.weight', 'decode_head.linear_c.2.proj.weight', 'decode_head.linear_c.1.proj.weight', 'decode_head.linear_fuse.weight', 'decode_head.linear_c.0.proj.weight', 'decode_head.classifier.weight']
- This IS expected if you are initializing SegformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SegformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Scanning dataset for minority‑class voxels …
Epoch 001/100  head_lr=1.19e-06  enc_lr=0.00e+00
Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)
[001/100] train_loss=1.978 train_acc=0.656 | val_loss=1.224 val_acc=1.000
    IoU  [1.000, 0.040, 0.037]
    F1   [1.000, 0.077, 0.072]
    Rcl  [1.000, 0.063, 0.080]
    Prc  [1.000, 0.098, 0.065]
    AccC [1.000, 0.063, 0.080]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 002/100  head_lr=2.18e-06  enc_lr=0.00e+00
[002/100] train_loss=1.361 train_acc=0.996 | val_loss=0.908 val_acc=1.000
    IoU  [1.000, 0.125, 0.040]
    F1   [1.000, 0.223, 0.078]
    Rcl  [1.000, 0.196, 0.078]
    Prc  [1.000, 0.258, 0.077]
    AccC [1.000, 0.196, 0.078]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 003/100  head_lr=3.17e-06  enc_lr=0.00e+00
[003/100] train_loss=1.065 train_acc=0.999 | val_loss=0.823 val_acc=1.000
    IoU  [1.000, 0.205, 0.036]
    F1   [1.000, 0.340, 0.070]
    Rcl  [1.000, 0.437, 0.097]
    Prc  [1.000, 0.279, 0.054]
    AccC [1.000, 0.437, 0.097]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 004/100  head_lr=4.16e-06  enc_lr=0.00e+00
[004/100] train_loss=1.009 train_acc=0.999 | val_loss=0.760 val_acc=0.999
    IoU  [0.999, 0.237, 0.081]
    F1   [1.000, 0.384, 0.150]
    Rcl  [1.000, 0.619, 0.408]
    Prc  [1.000, 0.278, 0.092]
    AccC [1.000, 0.619, 0.408]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 005/100  head_lr=5.15e-06  enc_lr=0.00e+00
[005/100] train_loss=0.984 train_acc=0.998 | val_loss=0.711 val_acc=0.999
    IoU  [0.999, 0.236, 0.095]
    F1   [1.000, 0.382, 0.173]
    Rcl  [0.999, 0.765, 0.283]
    Prc  [1.000, 0.255, 0.124]
    AccC [0.999, 0.765, 0.283]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 006/100  head_lr=6.14e-06  enc_lr=0.00e+00
[006/100] train_loss=0.915 train_acc=0.998 | val_loss=0.655 val_acc=0.999
    IoU  [0.999, 0.211, 0.104]
    F1   [1.000, 0.349, 0.189]
    Rcl  [0.999, 0.854, 0.607]
    Prc  [1.000, 0.219, 0.112]
    AccC [0.999, 0.854, 0.607]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 007/100  head_lr=7.13e-06  enc_lr=0.00e+00
[007/100] train_loss=0.920 train_acc=0.998 | val_loss=0.601 val_acc=0.999
    IoU  [0.999, 0.280, 0.149]
    F1   [1.000, 0.438, 0.259]
    Rcl  [0.999, 0.877, 0.546]
    Prc  [1.000, 0.292, 0.169]
    AccC [0.999, 0.877, 0.546]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 008/100  head_lr=8.12e-06  enc_lr=0.00e+00
[008/100] train_loss=0.857 train_acc=0.998 | val_loss=0.553 val_acc=0.999
    IoU  [0.999, 0.298, 0.173]
    F1   [1.000, 0.459, 0.295]
    Rcl  [0.999, 0.925, 0.523]
    Prc  [1.000, 0.305, 0.205]
    AccC [0.999, 0.925, 0.523]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 009/100  head_lr=9.11e-06  enc_lr=0.00e+00
[009/100] train_loss=0.883 train_acc=0.998 | val_loss=0.508 val_acc=0.999
    IoU  [0.999, 0.268, 0.144]
    F1   [1.000, 0.423, 0.251]
    Rcl  [0.999, 0.963, 0.588]
    Prc  [1.000, 0.271, 0.160]
    AccC [0.999, 0.963, 0.588]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 010/100  head_lr=1.01e-05  enc_lr=0.00e+00
[010/100] train_loss=0.878 train_acc=0.998 | val_loss=0.476 val_acc=0.999
    IoU  [0.999, 0.250, 0.102]
    F1   [1.000, 0.400, 0.185]
    Rcl  [0.999, 0.861, 0.728]
    Prc  [1.000, 0.261, 0.106]
    AccC [0.999, 0.861, 0.728]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 011/100  head_lr=1.11e-05  enc_lr=0.00e+00
[011/100] train_loss=0.721 train_acc=0.999 | val_loss=0.443 val_acc=1.000
    IoU  [1.000, 0.351, 0.155]
    F1   [1.000, 0.519, 0.269]
    Rcl  [1.000, 0.853, 0.802]
    Prc  [1.000, 0.373, 0.162]
    AccC [1.000, 0.853, 0.802]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 012/100  head_lr=1.21e-05  enc_lr=0.00e+00
[012/100] train_loss=0.717 train_acc=0.998 | val_loss=0.422 val_acc=0.999
    IoU  [0.999, 0.300, 0.184]
    F1   [1.000, 0.461, 0.311]
    Rcl  [0.999, 0.975, 0.519]
    Prc  [1.000, 0.302, 0.222]
    AccC [0.999, 0.975, 0.519]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 013/100  head_lr=1.31e-05  enc_lr=0.00e+00
[013/100] train_loss=0.690 train_acc=0.999 | val_loss=0.398 val_acc=1.000
    IoU  [1.000, 0.401, 0.187]
    F1   [1.000, 0.572, 0.316]
    Rcl  [1.000, 0.902, 0.730]
    Prc  [1.000, 0.419, 0.201]
    AccC [1.000, 0.902, 0.730]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 014/100  head_lr=1.41e-05  enc_lr=0.00e+00
[014/100] train_loss=0.701 train_acc=0.999 | val_loss=0.383 val_acc=1.000
    IoU  [1.000, 0.451, 0.184]
    F1   [1.000, 0.622, 0.311]
    Rcl  [1.000, 0.994, 0.263]
    Prc  [1.000, 0.452, 0.381]
    AccC [1.000, 0.994, 0.263]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 015/100  head_lr=1.50e-05  enc_lr=0.00e+00
[015/100] train_loss=0.564 train_acc=1.000 | val_loss=0.363 val_acc=1.000
    IoU  [1.000, 0.582, 0.354]
    F1   [1.000, 0.736, 0.522]
    Rcl  [1.000, 0.969, 0.687]
    Prc  [1.000, 0.593, 0.421]
    AccC [1.000, 0.969, 0.687]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 016/100  head_lr=1.60e-05  enc_lr=0.00e+00
[016/100] train_loss=0.638 train_acc=0.999 | val_loss=0.357 val_acc=1.000
    IoU  [1.000, 0.359, 0.120]
    F1   [1.000, 0.529, 0.214]
    Rcl  [1.000, 0.636, 0.916]
    Prc  [1.000, 0.452, 0.121]
    AccC [1.000, 0.636, 0.916]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 017/100  head_lr=1.70e-05  enc_lr=0.00e+00
[017/100] train_loss=0.569 train_acc=0.999 | val_loss=0.343 val_acc=1.000
    IoU  [1.000, 0.580, 0.285]
    F1   [1.000, 0.734, 0.444]
    Rcl  [1.000, 0.991, 0.361]
    Prc  [1.000, 0.583, 0.577]
    AccC [1.000, 0.991, 0.361]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 018/100  head_lr=1.80e-05  enc_lr=0.00e+00
[018/100] train_loss=0.583 train_acc=0.999 | val_loss=0.337 val_acc=1.000
    IoU  [1.000, 0.634, 0.283]
    F1   [1.000, 0.776, 0.441]
    Rcl  [1.000, 0.896, 0.792]
    Prc  [1.000, 0.685, 0.306]
    AccC [1.000, 0.896, 0.792]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 019/100  head_lr=1.90e-05  enc_lr=0.00e+00
[019/100] train_loss=0.580 train_acc=1.000 | val_loss=0.329 val_acc=1.000
    IoU  [1.000, 0.607, 0.286]
    F1   [1.000, 0.755, 0.445]
    Rcl  [1.000, 0.915, 0.708]
    Prc  [1.000, 0.643, 0.324]
    AccC [1.000, 0.915, 0.708]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 020/100  head_lr=2.00e-05  enc_lr=0.00e+00
[020/100] train_loss=0.547 train_acc=0.999 | val_loss=0.324 val_acc=1.000
    IoU  [1.000, 0.629, 0.301]
    F1   [1.000, 0.772, 0.462]
    Rcl  [1.000, 0.919, 0.735]
    Prc  [1.000, 0.666, 0.337]
    AccC [1.000, 0.919, 0.735]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
→ Unfroze backbones at epoch 21
Epoch 021/100  head_lr=2.00e-05  enc_lr=1.19e-06
[021/100] train_loss=0.537 train_acc=1.000 | val_loss=0.296 val_acc=1.000
    IoU  [1.000, 0.762, 0.298]
    F1   [1.000, 0.865, 0.459]
    Rcl  [1.000, 0.987, 0.349]
    Prc  [1.000, 0.770, 0.669]
    AccC [1.000, 0.987, 0.349]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 022/100  head_lr=2.00e-05  enc_lr=2.18e-06
[022/100] train_loss=0.441 train_acc=1.000 | val_loss=0.324 val_acc=1.000
    IoU  [1.000, 0.635, 0.353]
    F1   [1.000, 0.777, 0.522]
    Rcl  [1.000, 0.925, 0.684]
    Prc  [1.000, 0.670, 0.422]
    AccC [1.000, 0.925, 0.684]
Epoch 023/100  head_lr=2.00e-05  enc_lr=3.17e-06
[023/100] train_loss=0.391 train_acc=1.000 | val_loss=0.318 val_acc=1.000
    IoU  [1.000, 0.808, 0.060]
    F1   [1.000, 0.894, 0.113]
    Rcl  [1.000, 0.997, 0.062]
    Prc  [1.000, 0.810, 0.686]
    AccC [1.000, 0.997, 0.062]
Epoch 024/100  head_lr=2.00e-05  enc_lr=4.16e-06
[024/100] train_loss=0.356 train_acc=1.000 | val_loss=0.288 val_acc=1.000
    IoU  [1.000, 0.905, 0.477]
    F1   [1.000, 0.950, 0.646]
    Rcl  [1.000, 0.924, 0.838]
    Prc  [1.000, 0.978, 0.525]
    AccC [1.000, 0.924, 0.838]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 025/100  head_lr=2.00e-05  enc_lr=5.15e-06
[025/100] train_loss=0.336 train_acc=1.000 | val_loss=0.302 val_acc=1.000
    IoU  [1.000, 0.604, 0.292]
    F1   [1.000, 0.753, 0.452]
    Rcl  [1.000, 0.940, 0.489]
    Prc  [1.000, 0.629, 0.421]
    AccC [1.000, 0.940, 0.489]
Epoch 026/100  head_lr=2.00e-05  enc_lr=6.14e-06
[026/100] train_loss=0.348 train_acc=1.000 | val_loss=0.283 val_acc=1.000
    IoU  [1.000, 0.946, 0.624]
    F1   [1.000, 0.972, 0.768]
    Rcl  [1.000, 0.957, 0.889]
    Prc  [1.000, 0.988, 0.676]
    AccC [1.000, 0.957, 0.889]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 027/100  head_lr=2.00e-05  enc_lr=7.13e-06
[027/100] train_loss=0.310 train_acc=1.000 | val_loss=0.287 val_acc=1.000
    IoU  [1.000, 0.947, 0.525]
    F1   [1.000, 0.973, 0.688]
    Rcl  [1.000, 0.994, 0.557]
    Prc  [1.000, 0.953, 0.901]
    AccC [1.000, 0.994, 0.557]
Epoch 028/100  head_lr=2.00e-05  enc_lr=8.12e-06
[028/100] train_loss=0.275 train_acc=1.000 | val_loss=0.270 val_acc=1.000
    IoU  [1.000, 0.822, 0.652]
    F1   [1.000, 0.902, 0.789]
    Rcl  [1.000, 0.965, 0.880]
    Prc  [1.000, 0.847, 0.715]
    AccC [1.000, 0.965, 0.880]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 029/100  head_lr=2.00e-05  enc_lr=9.11e-06
[029/100] train_loss=0.277 train_acc=1.000 | val_loss=0.265 val_acc=1.000
    IoU  [1.000, 0.968, 0.705]
    F1   [1.000, 0.984, 0.827]
    Rcl  [1.000, 0.990, 0.778]
    Prc  [1.000, 0.978, 0.883]
    AccC [1.000, 0.990, 0.778]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 030/100  head_lr=2.00e-05  enc_lr=1.01e-05
[030/100] train_loss=0.265 train_acc=1.000 | val_loss=0.263 val_acc=1.000
    IoU  [1.000, 0.972, 0.747]
    F1   [1.000, 0.986, 0.855]
    Rcl  [1.000, 0.987, 0.842]
    Prc  [1.000, 0.984, 0.869]
    AccC [1.000, 0.987, 0.842]
✔ Saved best → FusedSwinCrossEntropy_tpi_clr_swin_best.pth
Epoch 031/100  head_lr=2.00e-05  enc_lr=1.11e-05
[031/100] train_loss=0.255 train_acc=1.000 | val_loss=0.268 val_acc=1.000
    IoU  [1.000, 0.970, 0.758]
    F1   [1.000, 0.985, 0.862]
    Rcl  [1.000, 0.977, 0.928]
    Prc  [1.000, 0.993, 0.805]
    AccC [1.000, 0.977, 0.928]
Epoch 032/100  head_lr=2.00e-05  enc_lr=1.21e-05
[032/100] train_loss=0.250 train_acc=1.000 | val_loss=0.277 val_acc=1.000
    IoU  [1.000, 0.956, 0.691]
    F1   [1.000, 0.977, 0.818]
    Rcl  [1.000, 0.959, 0.970]
    Prc  [1.000, 0.996, 0.707]
    AccC [1.000, 0.959, 0.970]
Epoch 033/100  head_lr=2.00e-05  enc_lr=1.31e-05
[033/100] train_loss=0.209 train_acc=1.000 | val_loss=0.299 val_acc=1.000
    IoU  [1.000, 0.952, 0.678]
    F1   [1.000, 0.975, 0.808]
    Rcl  [1.000, 0.952, 0.999]
    Prc  [1.000, 1.000, 0.678]
    AccC [1.000, 0.952, 0.999]
Epoch 034/100  head_lr=2.00e-05  enc_lr=1.41e-05
[034/100] train_loss=0.230 train_acc=1.000 | val_loss=0.301 val_acc=1.000
    IoU  [1.000, 0.991, 0.911]
    F1   [1.000, 0.995, 0.954]
    Rcl  [1.000, 0.999, 0.921]
    Prc  [1.000, 0.992, 0.989]
    AccC [1.000, 0.999, 0.921]
Epoch 035/100  head_lr=2.00e-05  enc_lr=1.50e-05
[035/100] train_loss=0.224 train_acc=1.000 | val_loss=0.314 val_acc=1.000
    IoU  [1.000, 0.961, 0.611]
    F1   [1.000, 0.980, 0.759]
    Rcl  [1.000, 0.998, 0.625]
    Prc  [1.000, 0.963, 0.966]
    AccC [1.000, 0.998, 0.625]
Epoch 036/100  head_lr=2.00e-05  enc_lr=1.60e-05
[036/100] train_loss=0.199 train_acc=1.000 | val_loss=0.292 val_acc=1.000
    IoU  [1.000, 0.990, 0.909]
    F1   [1.000, 0.995, 0.952]
    Rcl  [1.000, 0.994, 0.966]
    Prc  [1.000, 0.997, 0.939]
    AccC [1.000, 0.994, 0.966]
Epoch 037/100  head_lr=2.00e-05  enc_lr=1.70e-05
[037/100] train_loss=0.199 train_acc=1.000 | val_loss=0.286 val_acc=1.000
    IoU  [1.000, 0.957, 0.561]
    F1   [1.000, 0.978, 0.719]
    Rcl  [1.000, 0.998, 0.575]
    Prc  [1.000, 0.959, 0.960]
    AccC [1.000, 0.998, 0.575]
Epoch 038/100  head_lr=2.00e-05  enc_lr=1.80e-05
[038/100] train_loss=0.182 train_acc=1.000 | val_loss=0.291 val_acc=1.000
    IoU  [1.000, 0.978, 0.785]
    F1   [1.000, 0.989, 0.880]
    Rcl  [1.000, 0.998, 0.804]
    Prc  [1.000, 0.981, 0.971]
    AccC [1.000, 0.998, 0.804]
Epoch 039/100  head_lr=2.00e-05  enc_lr=1.90e-05
[039/100] train_loss=0.189 train_acc=1.000 | val_loss=0.295 val_acc=1.000
    IoU  [1.000, 0.987, 0.888]
    F1   [1.000, 0.994, 0.941]
    Rcl  [1.000, 0.988, 0.992]
    Prc  [1.000, 0.999, 0.895]
    AccC [1.000, 0.988, 0.992]
Epoch 040/100  head_lr=2.00e-05  enc_lr=2.00e-05
[040/100] train_loss=0.173 train_acc=1.000 | val_loss=0.281 val_acc=1.000
    IoU  [1.000, 0.996, 0.963]
    F1   [1.000, 0.998, 0.981]
    Rcl  [1.000, 0.998, 0.982]
    Prc  [1.000, 0.998, 0.980]
    AccC [1.000, 0.998, 0.982]
✘ Early stopping (no val‑loss improvement).

Inference:
  saved pred_0000.npy & pred_0000.las
  saved pred_0001.npy & pred_0001.las
  saved pred_0002.npy & pred_0002.las
  saved pred_0003.npy & pred_0003.las
  saved pred_0004.npy & pred_0004.las
  saved pred_0005.npy & pred_0005.las
  saved pred_0006.npy & pred_0006.las
  saved pred_0007.npy & pred_0007.las
  saved pred_0008.npy & pred_0008.las
  saved pred_0009.npy & pred_0009.las
  saved pred_0010.npy & pred_0010.las
  saved pred_0011.npy & pred_0011.las
  saved pred_0012.npy & pred_0012.las
  saved pred_0013.npy & pred_0013.las
  saved pred_0014.npy & pred_0014.las
  saved pred_0015.npy & pred_0015.las
  saved pred_0016.npy & pred_0016.las
  saved pred_0017.npy & pred_0017.las
  saved pred_0018.npy & pred_0018.las
  saved pred_0019.npy & pred_0019.las
  saved pred_0020.npy & pred_0020.las
  saved pred_0021.npy & pred_0021.las
  saved pred_0022.npy & pred_0022.las
  saved pred_0023.npy & pred_0023.las
  saved pred_0024.npy & pred_0024.las
  saved pred_0025.npy & pred_0025.las
  saved pred_0026.npy & pred_0026.las
  saved pred_0027.npy & pred_0027.las
  saved pred_0028.npy & pred_0028.las
  saved pred_0029.npy & pred_0029.las
  saved pred_0030.npy & pred_0030.las
  saved pred_0031.npy & pred_0031.las
  saved pred_0032.npy & pred_0032.las
  saved pred_0033.npy & pred_0033.las
  saved pred_0034.npy & pred_0034.las
  saved pred_0035.npy & pred_0035.las
