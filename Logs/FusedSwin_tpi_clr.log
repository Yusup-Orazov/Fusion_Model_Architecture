Unable to disable persistence mode for GPU 00000000:5E:00.0: Insufficient Permissions
Unable to disable persistence mode for GPU 00000000:D8:00.0: Insufficient Permissions
Some weights of the model checkpoint at nvidia/segformer-b0-finetuned-ade-512-512 were not used when initializing SegformerModel: ['decode_head.classifier.weight', 'decode_head.batch_norm.weight', 'decode_head.linear_c.0.proj.bias', 'decode_head.linear_c.3.proj.weight', 'decode_head.linear_fuse.weight', 'decode_head.batch_norm.bias', 'decode_head.linear_c.3.proj.bias', 'decode_head.batch_norm.running_mean', 'decode_head.batch_norm.num_batches_tracked', 'decode_head.linear_c.1.proj.weight', 'decode_head.linear_c.2.proj.weight', 'decode_head.batch_norm.running_var', 'decode_head.linear_c.1.proj.bias', 'decode_head.linear_c.0.proj.weight', 'decode_head.classifier.bias', 'decode_head.linear_c.2.proj.bias']
- This IS expected if you are initializing SegformerModel from the checkpoint of a model trained on another task or with another architecture (e.g. initializing a BertForSequenceClassification model from a BertForPreTraining model).
- This IS NOT expected if you are initializing SegformerModel from the checkpoint of a model that you expect to be exactly identical (initializing a BertForSequenceClassification model from a BertForSequenceClassification model).
Scanning dataset for minority‑class voxels …
Epoch 001/100  head_lr=1.19e-06  enc_lr=0.00e+00
Applied workaround for CuDNN issue, install nvrtc.so (Triggered internally at ../aten/src/ATen/native/cudnn/Conv_v8.cpp:80.)
[001/100] train_loss=2.953 train_acc=0.613 | val_loss=2.114 val_acc=0.999
    IoU  [0.999, 0.002, 0.001]
    F1   [0.999, 0.004, 0.002]
    Rcl  [0.999, 0.009, 0.001]
    Prc  [1.000, 0.003, 0.077]
    AccC [0.999, 0.009, 0.001]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 002/100  head_lr=2.18e-06  enc_lr=0.00e+00
[002/100] train_loss=2.063 train_acc=0.989 | val_loss=1.672 val_acc=0.999
    IoU  [0.999, 0.074, 0.003]
    F1   [1.000, 0.138, 0.006]
    Rcl  [1.000, 0.217, 0.003]
    Prc  [1.000, 0.101, 0.231]
    AccC [1.000, 0.217, 0.003]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 003/100  head_lr=3.17e-06  enc_lr=0.00e+00
[003/100] train_loss=1.828 train_acc=0.997 | val_loss=1.526 val_acc=0.999
    IoU  [0.999, 0.110, 0.000]
    F1   [0.999, 0.199, 0.000]
    Rcl  [0.999, 0.719, 0.000]
    Prc  [1.000, 0.115, 0.000]
    AccC [0.999, 0.719, 0.000]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 004/100  head_lr=4.16e-06  enc_lr=0.00e+00
[004/100] train_loss=1.708 train_acc=0.997 | val_loss=1.399 val_acc=0.999
    IoU  [0.999, 0.156, 0.000]
    F1   [0.999, 0.269, 0.000]
    Rcl  [0.999, 0.756, 0.000]
    Prc  [1.000, 0.164, 0.000]
    AccC [0.999, 0.756, 0.000]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 005/100  head_lr=5.15e-06  enc_lr=0.00e+00
[005/100] train_loss=1.511 train_acc=0.999 | val_loss=1.269 val_acc=1.000
    IoU  [1.000, 0.301, 0.000]
    F1   [1.000, 0.462, 0.000]
    Rcl  [1.000, 0.743, 0.000]
    Prc  [1.000, 0.336, 0.000]
    AccC [1.000, 0.743, 0.000]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 006/100  head_lr=6.14e-06  enc_lr=0.00e+00
[006/100] train_loss=1.508 train_acc=0.997 | val_loss=1.131 val_acc=0.999
    IoU  [0.999, 0.656, 0.000]
    F1   [0.999, 0.792, 0.000]
    Rcl  [0.999, 0.831, 0.005]
    Prc  [1.000, 0.756, 0.000]
    AccC [0.999, 0.831, 0.005]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 007/100  head_lr=7.13e-06  enc_lr=0.00e+00
[007/100] train_loss=1.328 train_acc=0.998 | val_loss=0.992 val_acc=0.999
    IoU  [0.999, 0.800, 0.000]
    F1   [0.999, 0.889, 0.000]
    Rcl  [0.999, 0.887, 0.003]
    Prc  [1.000, 0.891, 0.000]
    AccC [0.999, 0.887, 0.003]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 008/100  head_lr=8.12e-06  enc_lr=0.00e+00
[008/100] train_loss=1.197 train_acc=0.997 | val_loss=0.930 val_acc=0.999
    IoU  [0.999, 0.894, 0.000]
    F1   [0.999, 0.944, 0.000]
    Rcl  [0.999, 0.988, 0.000]
    Prc  [1.000, 0.904, 0.000]
    AccC [0.999, 0.988, 0.000]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 009/100  head_lr=9.11e-06  enc_lr=0.00e+00
[009/100] train_loss=1.126 train_acc=0.998 | val_loss=0.869 val_acc=0.999
    IoU  [0.999, 0.888, 0.000]
    F1   [1.000, 0.941, 0.000]
    Rcl  [0.999, 0.980, 0.000]
    Prc  [1.000, 0.905, 0.000]
    AccC [0.999, 0.980, 0.000]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 010/100  head_lr=1.01e-05  enc_lr=0.00e+00
[010/100] train_loss=1.102 train_acc=0.998 | val_loss=0.830 val_acc=0.999
    IoU  [0.999, 0.901, 0.000]
    F1   [1.000, 0.948, 0.000]
    Rcl  [0.999, 0.992, 0.003]
    Prc  [1.000, 0.908, 0.000]
    AccC [0.999, 0.992, 0.003]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 011/100  head_lr=1.11e-05  enc_lr=0.00e+00
[011/100] train_loss=1.133 train_acc=0.997 | val_loss=0.797 val_acc=0.999
    IoU  [0.999, 0.889, 0.000]
    F1   [1.000, 0.941, 0.001]
    Rcl  [0.999, 0.978, 0.008]
    Prc  [1.000, 0.907, 0.000]
    AccC [0.999, 0.978, 0.008]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 012/100  head_lr=1.21e-05  enc_lr=0.00e+00
[012/100] train_loss=0.989 train_acc=0.999 | val_loss=0.765 val_acc=1.000
    IoU  [1.000, 0.856, 0.003]
    F1   [1.000, 0.922, 0.007]
    Rcl  [1.000, 0.938, 0.052]
    Prc  [1.000, 0.907, 0.004]
    AccC [1.000, 0.938, 0.052]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 013/100  head_lr=1.31e-05  enc_lr=0.00e+00
[013/100] train_loss=0.925 train_acc=0.999 | val_loss=0.632 val_acc=1.000
    IoU  [1.000, 0.872, 0.139]
    F1   [1.000, 0.931, 0.244]
    Rcl  [1.000, 0.931, 0.326]
    Prc  [1.000, 0.932, 0.195]
    AccC [1.000, 0.931, 0.326]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 014/100  head_lr=1.41e-05  enc_lr=0.00e+00
[014/100] train_loss=0.848 train_acc=0.999 | val_loss=0.533 val_acc=1.000
    IoU  [1.000, 0.920, 0.371]
    F1   [1.000, 0.958, 0.541]
    Rcl  [1.000, 0.960, 0.580]
    Prc  [1.000, 0.956, 0.507]
    AccC [1.000, 0.960, 0.580]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 015/100  head_lr=1.50e-05  enc_lr=0.00e+00
[015/100] train_loss=0.841 train_acc=0.999 | val_loss=0.514 val_acc=1.000
    IoU  [1.000, 0.928, 0.443]
    F1   [1.000, 0.963, 0.614]
    Rcl  [1.000, 0.968, 0.579]
    Prc  [1.000, 0.958, 0.654]
    AccC [1.000, 0.968, 0.579]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 016/100  head_lr=1.60e-05  enc_lr=0.00e+00
[016/100] train_loss=0.920 train_acc=1.000 | val_loss=0.547 val_acc=1.000
    IoU  [1.000, 0.927, 0.301]
    F1   [1.000, 0.962, 0.463]
    Rcl  [1.000, 0.990, 0.328]
    Prc  [1.000, 0.936, 0.786]
    AccC [1.000, 0.990, 0.328]
Epoch 017/100  head_lr=1.70e-05  enc_lr=0.00e+00
[017/100] train_loss=0.696 train_acc=1.000 | val_loss=0.496 val_acc=1.000
    IoU  [1.000, 0.938, 0.442]
    F1   [1.000, 0.968, 0.613]
    Rcl  [1.000, 0.986, 0.503]
    Prc  [1.000, 0.951, 0.785]
    AccC [1.000, 0.986, 0.503]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 018/100  head_lr=1.80e-05  enc_lr=0.00e+00
[018/100] train_loss=0.801 train_acc=0.999 | val_loss=0.509 val_acc=1.000
    IoU  [1.000, 0.931, 0.335]
    F1   [1.000, 0.964, 0.502]
    Rcl  [1.000, 0.991, 0.362]
    Prc  [1.000, 0.938, 0.818]
    AccC [1.000, 0.991, 0.362]
Epoch 019/100  head_lr=1.90e-05  enc_lr=0.00e+00
[019/100] train_loss=0.701 train_acc=1.000 | val_loss=0.449 val_acc=1.000
    IoU  [1.000, 0.950, 0.575]
    F1   [1.000, 0.975, 0.730]
    Rcl  [1.000, 0.982, 0.677]
    Prc  [1.000, 0.967, 0.793]
    AccC [1.000, 0.982, 0.677]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 020/100  head_lr=2.00e-05  enc_lr=0.00e+00
[020/100] train_loss=0.773 train_acc=1.000 | val_loss=0.498 val_acc=1.000
    IoU  [1.000, 0.933, 0.335]
    F1   [1.000, 0.965, 0.501]
    Rcl  [1.000, 0.993, 0.355]
    Prc  [1.000, 0.938, 0.856]
    AccC [1.000, 0.993, 0.355]
→ Unfroze backbones at epoch 21
Epoch 021/100  head_lr=2.00e-05  enc_lr=1.19e-06
[021/100] train_loss=0.714 train_acc=0.999 | val_loss=0.536 val_acc=1.000
    IoU  [1.000, 0.923, 0.204]
    F1   [1.000, 0.960, 0.339]
    Rcl  [1.000, 0.997, 0.210]
    Prc  [1.000, 0.926, 0.885]
    AccC [1.000, 0.997, 0.210]
Epoch 022/100  head_lr=2.00e-05  enc_lr=2.18e-06
[022/100] train_loss=0.520 train_acc=1.000 | val_loss=0.378 val_acc=1.000
    IoU  [1.000, 0.962, 0.688]
    F1   [1.000, 0.981, 0.815]
    Rcl  [1.000, 0.979, 0.827]
    Prc  [1.000, 0.982, 0.803]
    AccC [1.000, 0.979, 0.827]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 023/100  head_lr=2.00e-05  enc_lr=3.17e-06
[023/100] train_loss=0.521 train_acc=1.000 | val_loss=0.370 val_acc=1.000
    IoU  [1.000, 0.963, 0.650]
    F1   [1.000, 0.981, 0.788]
    Rcl  [1.000, 0.992, 0.698]
    Prc  [1.000, 0.970, 0.905]
    AccC [1.000, 0.992, 0.698]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 024/100  head_lr=2.00e-05  enc_lr=4.16e-06
[024/100] train_loss=0.507 train_acc=1.000 | val_loss=0.336 val_acc=1.000
    IoU  [1.000, 0.967, 0.716]
    F1   [1.000, 0.983, 0.834]
    Rcl  [1.000, 0.985, 0.816]
    Prc  [1.000, 0.981, 0.853]
    AccC [1.000, 0.985, 0.816]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 025/100  head_lr=2.00e-05  enc_lr=5.15e-06
[025/100] train_loss=0.441 train_acc=1.000 | val_loss=0.316 val_acc=1.000
    IoU  [1.000, 0.933, 0.794]
    F1   [1.000, 0.965, 0.885]
    Rcl  [1.000, 0.994, 0.838]
    Prc  [1.000, 0.938, 0.937]
    AccC [1.000, 0.994, 0.838]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 026/100  head_lr=2.00e-05  enc_lr=6.14e-06
[026/100] train_loss=0.462 train_acc=1.000 | val_loss=0.315 val_acc=1.000
    IoU  [1.000, 0.971, 0.743]
    F1   [1.000, 0.985, 0.853]
    Rcl  [1.000, 0.992, 0.800]
    Prc  [1.000, 0.979, 0.913]
    AccC [1.000, 0.992, 0.800]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 027/100  head_lr=2.00e-05  enc_lr=7.13e-06
[027/100] train_loss=0.379 train_acc=1.000 | val_loss=0.362 val_acc=1.000
    IoU  [1.000, 0.950, 0.485]
    F1   [1.000, 0.974, 0.653]
    Rcl  [1.000, 0.999, 0.487]
    Prc  [1.000, 0.951, 0.992]
    AccC [1.000, 0.999, 0.487]
Epoch 028/100  head_lr=2.00e-05  enc_lr=8.12e-06
[028/100] train_loss=0.391 train_acc=1.000 | val_loss=0.299 val_acc=1.000
    IoU  [1.000, 0.975, 0.791]
    F1   [1.000, 0.987, 0.883]
    Rcl  [1.000, 0.982, 0.929]
    Prc  [1.000, 0.993, 0.841]
    AccC [1.000, 0.982, 0.929]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 029/100  head_lr=2.00e-05  enc_lr=9.11e-06
[029/100] train_loss=0.364 train_acc=1.000 | val_loss=0.297 val_acc=1.000
    IoU  [1.000, 0.976, 0.797]
    F1   [1.000, 0.988, 0.887]
    Rcl  [1.000, 0.983, 0.925]
    Prc  [1.000, 0.992, 0.852]
    AccC [1.000, 0.983, 0.925]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 030/100  head_lr=2.00e-05  enc_lr=1.01e-05
[030/100] train_loss=0.346 train_acc=1.000 | val_loss=0.303 val_acc=1.000
    IoU  [1.000, 0.984, 0.841]
    F1   [1.000, 0.992, 0.913]
    Rcl  [1.000, 0.999, 0.847]
    Prc  [1.000, 0.985, 0.991]
    AccC [1.000, 0.999, 0.847]
Epoch 031/100  head_lr=2.00e-05  enc_lr=1.11e-05
[031/100] train_loss=0.375 train_acc=1.000 | val_loss=0.293 val_acc=1.000
    IoU  [1.000, 0.984, 0.848]
    F1   [1.000, 0.992, 0.918]
    Rcl  [1.000, 0.997, 0.865]
    Prc  [1.000, 0.987, 0.976]
    AccC [1.000, 0.997, 0.865]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 032/100  head_lr=2.00e-05  enc_lr=1.21e-05
[032/100] train_loss=0.306 train_acc=1.000 | val_loss=0.288 val_acc=1.000
    IoU  [1.000, 0.986, 0.862]
    F1   [1.000, 0.993, 0.926]
    Rcl  [1.000, 0.997, 0.882]
    Prc  [1.000, 0.988, 0.975]
    AccC [1.000, 0.997, 0.882]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 033/100  head_lr=2.00e-05  enc_lr=1.31e-05
[033/100] train_loss=0.280 train_acc=1.000 | val_loss=0.341 val_acc=1.000
    IoU  [1.000, 0.965, 0.641]
    F1   [1.000, 0.982, 0.781]
    Rcl  [1.000, 0.999, 0.644]
    Prc  [1.000, 0.965, 0.992]
    AccC [1.000, 0.999, 0.644]
Epoch 034/100  head_lr=2.00e-05  enc_lr=1.41e-05
[034/100] train_loss=0.315 train_acc=1.000 | val_loss=0.328 val_acc=1.000
    IoU  [1.000, 0.959, 0.712]
    F1   [1.000, 0.979, 0.832]
    Rcl  [1.000, 0.960, 0.990]
    Prc  [1.000, 0.999, 0.717]
    AccC [1.000, 0.960, 0.990]
Epoch 035/100  head_lr=2.00e-05  enc_lr=1.50e-05
[035/100] train_loss=0.321 train_acc=1.000 | val_loss=0.275 val_acc=1.000
    IoU  [1.000, 0.991, 0.918]
    F1   [1.000, 0.995, 0.957]
    Rcl  [1.000, 0.994, 0.966]
    Prc  [1.000, 0.997, 0.949]
    AccC [1.000, 0.994, 0.966]
✔ Saved best → fused_tpi_clr_swin_best.pth
Epoch 036/100  head_lr=2.00e-05  enc_lr=1.60e-05
[036/100] train_loss=0.302 train_acc=1.000 | val_loss=0.300 val_acc=1.000
    IoU  [1.000, 0.980, 0.829]
    F1   [1.000, 0.990, 0.906]
    Rcl  [1.000, 0.984, 0.953]
    Prc  [1.000, 0.995, 0.864]
    AccC [1.000, 0.984, 0.953]
Epoch 037/100  head_lr=2.00e-05  enc_lr=1.70e-05
[037/100] train_loss=0.296 train_acc=1.000 | val_loss=0.289 val_acc=1.000
    IoU  [1.000, 0.980, 0.804]
    F1   [1.000, 0.990, 0.891]
    Rcl  [1.000, 0.996, 0.832]
    Prc  [1.000, 0.983, 0.959]
    AccC [1.000, 0.996, 0.832]
Epoch 038/100  head_lr=2.00e-05  enc_lr=1.80e-05
[038/100] train_loss=0.243 train_acc=1.000 | val_loss=0.330 val_acc=1.000
    IoU  [1.000, 0.981, 0.826]
    F1   [1.000, 0.990, 0.905]
    Rcl  [1.000, 0.992, 0.885]
    Prc  [1.000, 0.988, 0.925]
    AccC [1.000, 0.992, 0.885]
Epoch 039/100  head_lr=2.00e-05  enc_lr=1.90e-05
[039/100] train_loss=0.268 train_acc=1.000 | val_loss=0.317 val_acc=1.000
    IoU  [1.000, 0.987, 0.880]
    F1   [1.000, 0.993, 0.936]
    Rcl  [1.000, 0.992, 0.945]
    Prc  [1.000, 0.994, 0.928]
    AccC [1.000, 0.992, 0.945]
Epoch 040/100  head_lr=2.00e-05  enc_lr=2.00e-05
[040/100] train_loss=0.248 train_acc=1.000 | val_loss=0.337 val_acc=1.000
    IoU  [1.000, 0.984, 0.853]
    F1   [1.000, 0.992, 0.921]
    Rcl  [1.000, 0.994, 0.903]
    Prc  [1.000, 0.990, 0.939]
    AccC [1.000, 0.994, 0.903]
Epoch 041/100  head_lr=2.00e-05  enc_lr=2.00e-05
[041/100] train_loss=0.263 train_acc=1.000 | val_loss=0.310 val_acc=1.000
    IoU  [1.000, 0.989, 0.901]
    F1   [1.000, 0.995, 0.948]
    Rcl  [1.000, 0.995, 0.942]
    Prc  [1.000, 0.994, 0.955]
    AccC [1.000, 0.995, 0.942]
Epoch 042/100  head_lr=2.00e-05  enc_lr=2.00e-05
[042/100] train_loss=0.254 train_acc=1.000 | val_loss=0.334 val_acc=1.000
    IoU  [1.000, 0.980, 0.827]
    F1   [1.000, 0.990, 0.905]
    Rcl  [1.000, 0.986, 0.944]
    Prc  [1.000, 0.994, 0.870]
    AccC [1.000, 0.986, 0.944]
Epoch 043/100  head_lr=2.00e-05  enc_lr=2.00e-05
[043/100] train_loss=0.256 train_acc=1.000 | val_loss=0.392 val_acc=1.000
    IoU  [1.000, 0.980, 0.807]
    F1   [1.000, 0.990, 0.893]
    Rcl  [1.000, 0.998, 0.818]
    Prc  [1.000, 0.982, 0.985]
    AccC [1.000, 0.998, 0.818]
Epoch 044/100  head_lr=2.00e-05  enc_lr=2.00e-05
[044/100] train_loss=0.250 train_acc=1.000 | val_loss=0.464 val_acc=1.000
    IoU  [1.000, 0.932, 0.417]
    F1   [1.000, 0.965, 0.589]
    Rcl  [1.000, 0.988, 0.467]
    Prc  [1.000, 0.943, 0.796]
    AccC [1.000, 0.988, 0.467]
Epoch 045/100  head_lr=2.00e-05  enc_lr=2.00e-05
[045/100] train_loss=0.278 train_acc=1.000 | val_loss=0.446 val_acc=1.000
    IoU  [1.000, 0.944, 0.644]
    F1   [1.000, 0.971, 0.783]
    Rcl  [1.000, 0.973, 0.755]
    Prc  [1.000, 0.969, 0.813]
    AccC [1.000, 0.973, 0.755]
✘ Early stopping (no val‑loss improvement).

Inference:
  saved pred_0000.npy & pred_0000.las
  saved pred_0001.npy & pred_0001.las
  saved pred_0002.npy & pred_0002.las
  saved pred_0003.npy & pred_0003.las
  saved pred_0004.npy & pred_0004.las
  saved pred_0005.npy & pred_0005.las
  saved pred_0006.npy & pred_0006.las
  saved pred_0007.npy & pred_0007.las
  saved pred_0008.npy & pred_0008.las
  saved pred_0009.npy & pred_0009.las
  saved pred_0010.npy & pred_0010.las
  saved pred_0011.npy & pred_0011.las
  saved pred_0012.npy & pred_0012.las
  saved pred_0013.npy & pred_0013.las
  saved pred_0014.npy & pred_0014.las
  saved pred_0015.npy & pred_0015.las
  saved pred_0016.npy & pred_0016.las
  saved pred_0017.npy & pred_0017.las
  saved pred_0018.npy & pred_0018.las
  saved pred_0019.npy & pred_0019.las
  saved pred_0020.npy & pred_0020.las
  saved pred_0021.npy & pred_0021.las
  saved pred_0022.npy & pred_0022.las
  saved pred_0023.npy & pred_0023.las
  saved pred_0024.npy & pred_0024.las
  saved pred_0025.npy & pred_0025.las
  saved pred_0026.npy & pred_0026.las
  saved pred_0027.npy & pred_0027.las
  saved pred_0028.npy & pred_0028.las
  saved pred_0029.npy & pred_0029.las
  saved pred_0030.npy & pred_0030.las
  saved pred_0031.npy & pred_0031.las
  saved pred_0032.npy & pred_0032.las
  saved pred_0033.npy & pred_0033.las
  saved pred_0034.npy & pred_0034.las
  saved pred_0035.npy & pred_0035.las
